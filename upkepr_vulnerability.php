<?php $metricsxData = getHtmlHowtoFix();?>
<section class="connection-page-overview">
    <div class="container">
        <div class="cstm-card">
            <div class="notifictatopn-message">
                <p class="upkpr-success " style=" text-align: center; font-size: 15px; color: #6f746f;display: none;"></p>
                <p class="upkpr-errors errors error" style=" text-align: center; font-size: 15px;display: none;"></p>
            </div>
            <div class="health-report-banner-header">


                <div class="health-report-header-left">
                    <span>
                        <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Detailed vulnerabilities</h2>
                        <p> Detailed information of vulnerabilities detected in your websites</p>
                    </span>

                </div>
                <?php if (!empty($responseDataVulnType) && !empty($responseDataPlan)) : ?>
                    <p>Last refreshed on <?= date('d F, Y H:i:s', strtotime($responseData->created_at)); ?></p>
                    <div class="upkepr-heading-text">
                        <a href="javascript:void(0)" style="margin: 0px;" class="primary-btn scan-now-btn" onclick="UPKPR_check_connection('<?= $type ?>',this)"> <i class="dashicons dashicons-update-alt"></i>Refresh</a>
                    </div>
                <?php endif; ?>

            </div>
            <?php if (empty($responseDataVulnType) && empty($responseDataPlan)) : ?>

                <div class="pulgin-welcome-banner-text">
                    <div class="scan-now"><a href="javascript:void(0)" class="primary-btn scan-now-btn" onclick="UPKPR_check_connection('<?= $type ?>',this)"><i class="fa-solid fa-expand"></i> Scan Now</a></div>
                </div>
            <?php endif; ?>
            <!-- <pre> -->
            <?php if (!empty($responseDataVulnType) || !empty($responseDataPlan)) :
                //print_r($responseData);die;
            ?>
                <div class="row vulnerabiliti-info">

                    <div class="col-md-4">
                        <div class="vulnerabiliti-item">
                            <span class="vulnerabiliti-item-score-value"><?= $responseData->core->vul ?></span>
                            <div class="vulnerabiliti-item-score">
                                <!-- <img src="images/core.png" /> -->
                                <h5>Core <br> Vulnerabilities</h5>
                            </div>
                            <ul class="vulnerabiliti-detected-list">
                                <?php if (version_compare(get_bloginfo('version'), $responseData->core->latest, '<')) : ?>
                                    <li class="risk-detected">Need to update</li>
                                <?php endif; ?>
                                <li class="risk-detected"> <?= $responseData->core->vul ?> Vulnerability found </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="vulnerabiliti-item">
                            <span class="vulnerabiliti-item-score-value"><?= $responseData->plugin->vul ?></span>
                            <div class="vulnerabiliti-item-score">
                                <!-- <img src="images/plugin.png" /> -->
                                <h5>Plugin <br> Vulnerabilities</h5>
                            </div>
                            <ul class="vulnerabiliti-detected-list">
                                <li class="risk-detected"><?= $responseData->plugin->vul ?> out of <?= $responseData->plugin->total ?> plugins are <span>Vulnerable</span></li>
                                <li class="warning-detected"><?= $responseData->plugin->deactivate ?> out of <?= $responseData->plugin->total ?> plugins are <span>Deactivated</span></li>
                                <li class="good-detected"><?= $responseData->plugin->update ?> out of <?= $responseData->plugin->total ?> plugins <span>Update</span> are available</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="vulnerabiliti-item">
                            <span class="vulnerabiliti-item-score-value"><?= $responseData->theme->vul ?></span>
                            <div class="vulnerabiliti-item-score">
                                <!-- <img src="images/theme.png" /> -->
                                <h5>Theme <br> Vulnerabilities</h5>
                            </div>
                            <ul class="vulnerabiliti-detected-list">
                                <li class="risk-detected"><?= $responseData->theme->vul ?> out of <?= $responseData->theme->total ?> themes are <span>Vulnerable</span></li>
                                <li class="warning-detected"><?= count((array)$responseData->theme->deactivate) ?> out of <?= $responseData->theme->total ?> themes are <span>Deactivated</span></li>
                                <li class="good-detected"><?= $responseData->theme->update ?> out of <?= $responseData->theme->total ?> themes <span>Update</span> are available</li>
                            </ul>
                        </div>
                    </div>



                </div>
            <?php endif; ?>

        </div>
    </div>
</section>

<?php if (!empty($responseDataVulnType) || !empty($responseDataPlan)) : ?>
    <!-- Show Vulnerability details -->
    <?php if (strtolower($responseDataPlan) != 'free') : ?>
        <section class="connection-page-table">
            <div class="container">
                <div class="cstm-card cstm-tab-content tab-content">
                    <div class="health-report-banner-header">
                        <div class="health-report-header-left">
                            <span>
                                <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Vulnerabilities Detail</h2>
                                <p>Please review the detailed information on vulnerabilities and find solutions to fix these issues to secure your WordPress website.</p>
                            </span>
                        </div>
                    </div>

                    <table class="table table-striped">
                        <thead>
                            <tr class="main-Heading-table-data-upkepr">
                                <th scope="col" colspan="2" style="padding-left: 18px;">
                                    <h2>Title</h2>
                                </th>
                                <th scope="col">
                                    <h2>Score</h2>
                                </th>
                                <?php if (strtolower($type) == strtolower('all')) : ?>
                                    <th scope="col">
                                        <h2>Type</h2>
                                    </th>
                                <?php endif; ?>
                                <!--  <th scope="col">
                                    <h2>Severity</h2>
                                </th> -->
                            </tr>
                        </thead>
                        <tbody class="result-upkepr-data">
                            <?php
                            if (!empty($responseDataVulnType)) :
                                foreach ($responseDataVulnType as $vuln) :
                                    $vulnDetails = !empty($vuln->news_info) ? json_decode($vuln->news_info) : '';
                            ?>
                                    <tr class="upkepr-PluginInf-data">
                                        <td>
                                            <a href="javascript:void(0);" class="upkpr-accordion-toggle"></a>
                                        </td>
                                        <td>
                                            <h4 class="plugin-data-upkepr-head"><?= isset($vulnDetails->software[0]->name) ? $vulnDetails->software[0]->name : $vulnDetails->software[0]->slug ?></h4>
                                            <p style="color:#777"><?= $vulnDetails->title ?></p>
                                        </td>
                                        <td>
                                            <p><?= isset($vulnDetails->cvss->score) ? $vulnDetails->cvss->score : 0 ?></p>
                                        </td>
                                        <?php if (strtolower($type) == strtolower('all')) : ?>
                                            <td class="table-type">
                                                <p><?= isset($vuln->type) ? ucfirst($vuln->type) : '' ?></p>
                                            </td>
                                        <?php endif; ?>
                                        <!-- <td style="width: 92px;">
                                            <p><? //= isset($vulnDetails->cvss->rating) ? $vulnDetails->cvss->rating : '' 
                                                ?></p>
                                        </td> -->

                                    </tr>
                                    <tr class="upkpr-accordion-content " style="display: none;">
                                        <td colspan="4">
                                            <table class="upkeresultDivData">
                                                <tbody>
                                                    <tr>
                                                        <td><strong> Introduced:</strong> <?= date_i18n($vuln->news_date) ?>
                                                            <br>
                                                            <strong>How to fix?</strong> <?= esc_html(@$vulnDetails->software[0]->remediation) ?>
                                                            <br><br>
                                                            <strong>Description:</strong> <?= esc_html(@$vulnDetails->description) ?>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                <?php endforeach;
                            else : ?>
                                <tr>
                                    <td colspan="4" style="text-align: center;">
                                        <span style="font-size: 16px;"><b>No records found.</b></span>
                                    </td>
                                </tr>
                            <?php endif; ?>
                        </tbody>
                    </table>


                </div>
            </div>
        </section>
    <?php else : ?>
        <!-- individual account -->

        <section class="connection-page-table connection-table-popup">
            <div class="container">
                <div class="cstm-card cstm-tab-content tab-content">
                    <div class="health-report-banner-header">
                        <div class="health-report-header-left">
                            <span>
                                <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Vulnerabilities Information</h2>
                                <p>Please review the detailed information on vulnerabilities and find solutions to fix these issues to secure your WordPress website.</p>
                            </span>
                        </div>
                    </div>
                    <div class="connection-vulnerbilities-table">
                        <div class="signup-more-details-popup">
                            <div class="signUpPopupPage">
                                <h2>Upgrade to Premium for Details <!-- <span class="highlight">Upkepr.</span> --></h2>
                                <p>“Currently, you're on a free plan which only allows you to view a summary of the vulnerabilities. To access detailed information on these vulnerabilities and their fixes, please upgrade to a premium plan. This will help you secure your WordPress website effectively.”</p>
                                <a target="_blank" href="https://app.upkepr.com/register" class="primary-btn"><i class="fa-solid fa-lock"></i> Login To Upkepr</a>
                            </div>
                        </div>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th scope="col">Title</th>
                                    <th scope="col">Score</th>
                                    <th scope="col">Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <h4 class="plugin-data-upkepr-head">WordPress</h4>
                                        <p>WordPress Core - All known versions - Unauthenticated Blind Server Side Request Forgery</p>
                                    </td>
                                    <td>4</td>
                                    <td><span class="table-type">Plugin</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <h4 class="plugin-data-upkepr-head">WordPress</h4>
                                        <p>WordPress Core - All known versions - Unauthenticated Blind Server Side Request Forgery</p>
                                    </td>
                                    <td>4</td>
                                    <td><span class="table-type">Plugin</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <h4 class="plugin-data-upkepr-head">WordPress</h4>
                                        <p>WordPress Core - All known versions - Unauthenticated Blind Server Side Request Forgery</p>
                                    </td>
                                    <td>4</td>
                                    <td><span class="table-type">Plugin</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <h4 class="plugin-data-upkepr-head">WordPress</h4>
                                        <p>WordPress Core - All known versions - Unauthenticated Blind Server Side Request Forgery</p>
                                    </td>
                                    <td>4</td>
                                    <td><span class="table-type">Plugin</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </section>
    <?php endif; ?>

<?php endif; ?>

<!-- Health reports start-->
<?php
$screentype = 'desktop';
$recommendedDataReports = $responseData->recommendation;
$data = isset($recommendedDataReports->reponse_data) ? json_decode($recommendedDataReports->reponse_data) : "";
if (empty($data)) {
} else {

$site_url = site_url();
$languageSugges = '';
$seoScore = $performanceScrore = $pageStructureScore = $accessibilityScore = 0;
$reorder = ['performance' => 'Speed', 'best-practices' => 'Page Structure', 'accessibility' => 'Accessibility', 'seo' => 'SEO'];
$cateroriesReports = isset($data->categories) ? $data->categories : "";
$performanceScrore = isset($cateroriesReports->performance->score) ? $cateroriesReports->performance->score * 100 : 0;
$pageStructureScore =  isset($cateroriesReports->{'best-practices'}->score) ? $cateroriesReports->{'best-practices'}->score * 100 : 0;

$accessibilityScore =  isset($cateroriesReports->accessibility->score) ? $cateroriesReports->accessibility->score * 100 : 0;
$seoScore =  isset($cateroriesReports->seo->score) ? $cateroriesReports->seo->score * 100 : 0;
$averageScore = round(($seoScore + $performanceScrore) / 2);
$getSpeedDetails = getFailedWarningPassedSpeed($data);
$recommendedData = getRecommendationCategoriesData($data);
$resposeData =  isset($data->allAudits) ? $data->allAudits : "";
$web = isset($recommendedDataReports->scraper_data_json) ? json_decode($recommendedDataReports->scraper_data_json) : "";
if(empty($web->viewportString)){
    if(count($recommendedData['accessibility']) > 0){
        $recommendedData['accessibility'] = array_merge($recommendedData['accessibility'],['Meta_Viewport' => isset($web->viewportString)?$web->viewportString:'']);
    } else {
        $recommendedData['accessibility']['Meta_Viewport'] = isset($web->canonical) ? $web->canonical:'';
    }
}

if(empty($web->canonical)){
    if(count($recommendedData['page_structure']) > 0){
        $recommendedData['page_structure'] = array_merge($recommendedData['page_structure'],[
            'URL_Canonicalization' =>isset($web->canonical) ? $web->canonical:'',
        ]);
    } else {
        $recommendedData['page_structure']['URL_Canonicalization']=isset($web->canonical) ? $web->canonical:'';
    }
}
$passedSeo = getSeoPassedData($data);

$performanceFailed = 0;
$performanceWarning = 0;
if (isset($recommendedData['performance'])) :
    foreach ($recommendedData as $keyName => $sectionHigValue) :
        if ($keyName != 'seo' && $keyName != 'passed') :
            foreach ($sectionHigValue as $keyInnterRec => $listValue) :
                if (gettype($keyInnterRec) == 'string' && !isset($listValue->id)) :
                    $performanceFailed = $performanceFailed + 1;
                elseif ($listValue->score <= '0.9' && '0.5' <= $listValue->score) :
                    $performanceWarning = $performanceWarning + 1;
                else :
                    $performanceFailed = $performanceFailed + 1;
                endif;
            endforeach;
        endif;
    endforeach;
endif;
$failedPerformance = !empty($performanceFailed) ? $performanceFailed : 0;
$warningPerformance = !empty($performanceWarning) ? $performanceWarning : 0;
$passedPerformance = !empty($recommendedData['passed']) ? $recommendedData['passed'] - count($passedSeo) : 0;
$totalPerAud = $failedPerformance + $warningPerformance + $passedPerformance;


if (isset($web)) {
    $seodAdvanceDataWithPackage = [
        'Meta_Title' => $web->title,
        'Meta_Description' => $web->description,
        'Social_Media_Meta_Tags' => ['social' => $web->openGraph, 'twitter' => $web->twitterCard],
        'Heading_Tags' => [
            'h1' => $web->h1,
            'h2' => $web->h2,
        ],
        'Image_Alt' => array_filter($web->imagesWithDetails, function ($images) {
            if (empty($images->alt))
                return true;
        }),
        'Charset_Declaration' => $web->charset,
        'Social_Media' => [
            'Facebook' => !empty($web->openGraph->{'og:title'}) ? 'true' : 'false',
            'twitter' => !empty($web->twitterCard->{'twitter:title'}) ? 'true' : 'false'
        ],
        //'Meta_Viewport' => $web->viewportString,
        'Canonical_Tag' => $web->canonical,
    ];
} else {
    $seodAdvanceDataWithPackage = [];
}

$scraperErrors = [];
foreach ($seodAdvanceDataWithPackage as $seokey => $seovalue) {
    if (is_array($seovalue)) {
        if ($seokey == 'Social_Media_Meta_Tags' && (empty($seovalue['social']) || empty($seovalue['twitter']))) {
            $scraperErrors[] = $seokey;
        } elseif ($seokey == 'Heading_Tags' && (empty($seovalue['h1']) || empty($seovalue['h2']))) {
            $scraperErrors[] = $seokey;
        } elseif ($seokey == 'Image_Alt' && (count($seovalue) > 0)) {
            $scraperErrors[] = $seokey;
        } elseif ($seokey == 'Social_Media' && ($seovalue['Facebook'] == 'false' || $seovalue['twitter'] == 'false')) {
            $scraperErrors[] = $seokey;
        }
    } elseif (empty($seovalue)) {
        $scraperErrors[] = $seokey;
    }
}
$seoFailed = 0;
$seoWarning = 0;
if (isset($recommendedData['performance'])) :
    foreach ($recommendedData as $keyName => $sectionHigValue) :
        if ($keyName == 'seo') :
            foreach ($sectionHigValue as $keyInnterRec => $listValue) :
                if (gettype($keyInnterRec) == 'string' && !isset($listValue->id)) :
                    $seoFailed = $seoFailed + 1;
                elseif ($listValue->score <= '0.9' && '0.5' <= $listValue->score) :
                    $seoWarning = $seoWarning + 1;
                elseif ($listValue->score < 0.5) :
                    $seoFailed = $seoFailed + 1;
                endif;
            endforeach;
        endif;
    endforeach;

endif;
$failedPerformanceSeo = !empty($seoFailed) ? $seoFailed + count($scraperErrors) : 0 + count($scraperErrors);
$warningPerformanceSeo = !empty($seoWarning) ? $seoWarning : 0;
$passedSeoArray = $passedSeo;
$passedSeo = count($passedSeo) + (count($seodAdvanceDataWithPackage) - count($scraperErrors));

$totalPerAudSeo = $failedPerformance + $warningPerformance + $passedSeo;

?>
<section class="website-health-report">
    <div class="container">
        <div class="health-report-banner">
            <div class="health-report-banner-header">
                <div class="health-report-header-left">
                    <img class="site-logo" src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/health-report-icon.png" alt="site-logo 2" />
                    <span>
                        <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Website health report</h2>
                        <a id="textToCopy" data-title="<?= @$_SERVER['HTTP_REFERER'] ?>" href="#"><?= isset($site_url) ? $site_url : '' ?></a>
                    </span>
                </div>
                <div class="health-report-header-right">
                    <div class="custom-notification" id="copyNotification" style="left: 1479.03px; display: none;">
                        Copied!
                    </div>
                    <!-- <a id="copyButton" class="copy-link"><i class="far fa-clone"></i>Copy Link</a> -->
                    <!-- <a href="#" class="brdr-btn download-pdf"><img src="<? //= HOME_URL
                                                                                ?>/assets/img/tools/website-analyse/download-pdf.png" alt="download-pdf">Download Pdf</a> -->
                </div>
            </div>
            <div class="health-report-overall-score">
                <div class="health-overall-score-left">
                    <div class="overall-score-main">
                        <img src="<?= UPKPR_MAINTENANCE_GET_DATA ?>/assets/uploads/report/<?= $averageScore ?>.png" alt="score <?= $averageScore ?>">
                        <div class="performance-overall-score-right">
                            <h4>Overall Site Score</h4>
                            <div class="last-date-cms">
                                <!-- <div class="last-date showResultTime"> Last Refresh Date:<span id="last_refresh_date">  <?//= date('d F, Y H:i:s', strtotime($responseData->created_at));?></span></div> -->
                                <!-- <div class="cms"><img style="display: none;" id="wordpressImg" src="<?//php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/wordpress-cms.png"><span id="cmsData"> </span></div> -->
                            </div>
                            <p>This website received an total score of <?= $averageScore?> out of 100, this website Grade is
                        <span class="<?=getColorOfText($averageScore)?>"><?php if($averageScore >= 90){ echo "Good";}elseif($averageScore < 90 && $averageScore >= 50 ){ echo "Need Improvement";} else { echo "Critical";}?></span>.
                        </p>
                        </div>
                    </div>
                </div>
               
                <div class="health-overall-score-right">
                    <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">
                    Log In for More Features
                    </h2>
                    <p class="discover-and-fix-vul">Upkepr provides daily/monthly health reports, regular alerts, team collaboration, and deeper insights with Google Analytics. Log in to access these features.</p>
                    <a target="_blank" href="https://app.upkepr.com/register" class="bg-btn"><i class="fa-solid fa-lock"></i> Login To Upkepr</a>
                </div>
               
            </div>

        </div>
    </div>
</section>
<section class="scan-summry-main">
    <div class="container">
        <div class="scan-summry-inner">

            <div class="scan-summry-left">
                <div class="scan-summry-header">
                    <img class="site-logo" src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/health-report-icon.png" alt="site-logo 2">
                    <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Scan summary</h2>
                </div>
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <button class="nav-link active" id="scans-summry-tab1" data-bs-toggle="pill" data-bs-target="#scans-summry1" type="button" role="tab" aria-controls="scans-summry1" aria-selected="true">
                        <img class="site-logo" src="<?= UPKPR_MAINTENANCE_GET_DATA ?>/assets/uploads/report/<?= $performanceScrore ?>.png">
                        <span>
                            <h3>Performance/Speed detail</h3>
                            <p>Refers to how quickly & efficiently a website loads & operates.</p>
                        </span>
                    </button>
                    <button class="nav-link" id="scans-summry-tab2" data-bs-toggle="pill" data-bs-target="#scans-summry2" type="button" role="tab" aria-controls="scans-summry2" aria-selected="false">
                        <img class="site-logo" src="<?= UPKPR_MAINTENANCE_GET_DATA ?>/assets/uploads/report/<?= $seoScore ?>.png">
                        <span>
                            <h3>SEO</h3>
                            <p> Ensuring website is easy to navigate with good user experience.</p>
                        </span>
                    </button>
                </div>
            </div>

            <div class="scan-summry-details">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="scans-summry1" role="tabpanel" aria-labelledby="scans-summry-tab1" tabindex="0">
                        <div class="health-report-banner-header">
                            <div class="health-report-header-left">
                                <img class="site-logo" src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/meter.png" alt="meter">
                                <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">Performance/Speed detail</h2>
                            </div>
                            <div class="scan-summry-details-tabs">
                                <ul class="nav nav-pills" id="pills-tab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/scan-detail-tab1.png">Critical Issues <span>(<?= isset($failedPerformance) ? $failedPerformance : '' ?>)</span></button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/scan-detail-tab2.png">Need Improvement <span>(<?= isset($warningPerformance) ? $warningPerformance : '' ?>)</span></button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="scan-summry-tab-details" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">

                                <?php
                                if (isset($recommendedData['performance']) && count($recommendedData['performance']) > 0) :
                                    foreach ($recommendedData['performance'] as $perforValue) :
                                        $score = @$perforValue->score;
                                        if (($score < 0.5  && $score >= 0)) : ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                   
                                                </a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach; ?>
                                    <?php endif;
                                if (isset($recommendedData['page_structure']) && count($recommendedData['page_structure']) > 0) :
                                    foreach ($recommendedData['page_structure'] as $pgStKey => $perforValue) :
                                        if(gettype($pgStKey) == 'string' && empty($perforValue)){ ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor(0) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4><?=ucfirst(str_replace('_', ' ', $pgStKey)) ?></h4>
                                                    <p> <?= $site_url ?> and <?= str_contains(parse_url($site_url)['host'], 'www') ? "https://" . parse_url($site_url)['host'] : 'https://www.' . parse_url($site_url)['host']; ?> should resolve to the same URL, but currently do not.</p>
                                                </div>
                                            </div>
                                        <?php } else {
                                            $score = @$perforValue->score;
                                            if (($score < 0.5  && $score >= 0)) : ?>
                                                <div class="scan-summry-detail-list">
                                                    <div class="scan-summry-detail-list-header">
                                                        <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                        <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                        <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                            <?= formatTextWithLinks($perforValue->description) ?></p>
                                                    </div>
                                                    <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                    <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                    </a>
                                                    <div class="mvbsbContentBox">
                                                        <?= @$metricsxData[$perforValue->id]; ?>
                                                    </div>
                                                </div>
                                            <?php endif;
                                        }
                                    endforeach; ?>
                                <?php endif;
                                if (isset($recommendedData['accessibility']) && count($recommendedData['accessibility']) > 0) :
                                    foreach ($recommendedData['accessibility'] as $accKey => $perforValue) :?>
                                        <div class="scan-summry-detail-list">
                                        <?php if( gettype($accKey) == 'string' && empty($perforValue)) : ?>
                                            <div class="scan-summry-detail-list-header">
                                                <span class="scan-detailes-list-icon <?= getIconColor(0) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                <h4><?=ucfirst(str_replace('_', ' ', $accKey)) ?></h4> 
                                                <p>This webpage is Not using a viewport meta tag.</p>                                               
                                            </div>
                                        <?php else :
                                         if (isset($perforValue->score) && ($perforValue->score < 0.5  && $perforValue->score >= 0)) : ?>
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                </a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                        <?php endif;?>
                                        <?php endif; ?>
                                    </div>
                                <?php endforeach; ?>
                                <?php endif; ?>
                                <?php if ($failedPerformance == 0) :?>
                                    <p class="not-found ">No records found.</p>
                                <?php endif; ?>
                                <div class="web-vitals-outer">
                                    <h2>Web Vitals</h2>
                                    <div class="web-vitals">

                                        <?= getMetricDataForPerf($data); ?>
                                    </div>
                                </div>

                            </div>
                            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">

                                <?php
                                if (isset($recommendedData['performance']) && count($recommendedData['performance']) > 0) :
                                    foreach ($recommendedData['performance'] as $perforValue) :
                                        $score = @$perforValue->score;
                                        if (($score < 0.9  && $score >= 0.5)) : ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>">
                                                        <!-- <img src="<?//php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"> -->
                                                        <i class="fa-solid fa-exclamation"></i>
                                                    </span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                </a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach; 
                                endif; ?>
                                <?php
                                if (isset($recommendedData['page_structure']) && count($recommendedData['page_structure']) > 0) :
                                    foreach ($recommendedData['page_structure'] as $perforValue) :
                                        $score = @$perforValue->score;
                                        if (($score < 0.9  && $score >= 0.5)) : ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                </a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach; 
                                endif; ?>
                                <?php
                                if (isset($recommendedData['accessibility']) && count($recommendedData['accessibility']) > 0) :
                                    foreach ($recommendedData['accessibility'] as $perforValue) :
                                        $score = @$perforValue->score;
                                        if (($score < 0.9  && $score >= 0.5)) : ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                </a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach; 
                                endif; ?>
                                <?php if($warningPerformance == 0):?>
                                    <p class="not-found ">No records found.</p>
                                <?php endif; ?>
                            </div>
                            <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">


                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="scans-summry2" role="tabpanel" aria-labelledby="scans-summry-tab2" tabindex="0">
                        <div class="health-report-banner-header">
                            <div class="health-report-header-left">
                                <img class="site-logo" src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/meter.png" alt="meter">
                                <h2 class="how-upkepr-protect-wordpress-websites outfit-bold-white-32px">SEO Details</h2>
                            </div>
                            <div class="scan-summry-details-tabs">
                                <ul class="nav nav-pills" id="pills-tab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="pills-home-tab1" data-bs-toggle="pill" data-bs-target="#pills-home1" type="button" role="tab" aria-controls="pills-home1" aria-selected="true"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/scan-detail-tab1.png">Critical Issues <span>(<?= isset($failedPerformanceSeo) ? $failedPerformanceSeo : '' ?>)</span></button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="pills-profile-tab2" data-bs-toggle="pill" data-bs-target="#pills-profile2" type="button" role="tab" aria-controls="pills-profile2" aria-selected="false"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/scan-detail-tab2.png">Need Improvement <span>(<?= isset($warningPerformanceSeo) ? $warningPerformanceSeo : '' ?>)</span></button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="pills-contact-tab3" data-bs-toggle="pill" data-bs-target="#pills-contact3" type="button" role="tab" aria-controls="pills-contact3" aria-selected="false"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/scan-detail-tab3.png">Good <span>(<?= isset($passedSeo) ? $passedSeo : '' ?>)</span></button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="scan-summry-tab-details" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="pills-home1" role="tabpanel" aria-labelledby="pills-home-tab">
                                <?php
                                if (isset($recommendedData['seo']) /* && count($recommendedData['seo']) > 0 */) :
                                    foreach ($recommendedData['seo'] as $perforValue) : ?>
                                        <div class="scan-summry-detail-list">
                                            <div class="scan-summry-detail-list-header">
                                                <span class="scan-detailes-list-icon"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                    <?= formatTextWithLinks($perforValue->description) ?></p>
                                            </div>
                                            <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                            <!-- <a href="javascript:void(0)" class="see-full-list hiderow-button-click">See Full List <i class="fa-solid fa-arrow-up-right-from-square"></i></a> -->
                                            <a href="javascript:void(0)" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i></a>
                                            <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                            </div>
                                        </div>
                                    <?php endforeach; ?>
                                    <?php foreach ($seodAdvanceDataWithPackage as $seoKey => $seoValue) :
                                        if (in_array($seoKey, $scraperErrors)) :

                                    ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class=" scan-detailes-list-icon tbliIcon <?= !in_array($seoKey, $scraperErrors) ? 'tbliIconGreen' : 'tbliIconRed'; ?> me-2">
                                                        <!-- <i class="fa-solid fa-<?//= !in_array($seoKey, $scraperErrors) ? 'check' : 'exclamation'; ?>"></i> -->
                                                        <?php if(!in_array($seoKey, $scraperErrors)):?>
                                                            <?php endif;?>
                                                            <img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png">
                                                         </span>
                                                    <h4> <?= str_replace('_', ' ', $seoKey) ?> </h4>
                                                </div>
                                                <?php if ($seoValue && is_array($seoValue)) : ?>
                                                    <?php if ($seoKey == 'Heading_Tags') : ?>
                                                        <p>This webpage contains headings tags</p>
                                                        <div class="mcbBlockText mcbBlockGreen">
                                                            <div class="row">
                                                                <?php foreach ($seoValue as $Hkey => $HseodAdvanceData) { ?>
                                                                    <div class="cstm-tab-content  col-6">
                                                                        <table class="table table table-striped">
                                                                            <thead class="social-table-containe">
                                                                                <th><?= $Hkey ?>
                                                                                    <hr>
                                                                                </th>
                                                                            </thead>
                                                                            <?php if(count($HseodAdvanceData) > 0):?>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td><?= implode("<br> \n", $HseodAdvanceData) ?></td>
                                                                                </tr>
                                                                            </tbody>
                                                                            <?php else: ?>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td>Missing tag</td>
                                                                                </tr>
                                                                            </tbody>
                                                                            <?php endif; ?>
                                                                        </table>
                                                                    </div>
                                                                <?php } ?>
                                                            </div>
                                                        </div>
                                                        <!-- Social media seo -->
                                                    <?php elseif ($seoKey == 'Social_Media_Meta_Tags') : ?>
                                                        <?php if (!empty($seoValue['social']) || !empty($seoValue['twitter'])) : ?>
                                                            <p>This webpage is using social media meta tags.</p>

                                                            <?php foreach ($seoValue as $Hkey => $HseodAdvanceData) { ?>
                                                                <header class="social-table-containe">
                                                                    <strong><?= ($Hkey == 'social') ? 'Open Graph Meta Tags' : 'Twitter Card Meta Tags'; ?></strong>
                                                                </header>
                                                                <div class="mcbBlockText mcbBlockGrey">
                                                                    <div class="cstm-tab-content table-responsive">
                                                                        <table class="table table table-striped ">
                                                                            <tbody>
                                                                                <?php foreach ($HseodAdvanceData as $keyM => $Mvalue) { ?>
                                                                                    <tr>
                                                                                        <td><?= $keyM ?></td>
                                                                                        <td><?= $Mvalue ?></td>
                                                                                    </tr>
                                                                                <?php } ?>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            <?php } ?>
                                                        <?php else : ?>
                                                            <p>This webpage is not using social media meta tags! While this type of meta tags don't affect what
                                                                people see when they visit the webpage, they exist to provide information about it to search engines
                                                                and social media platforms.</p>
                                                        <?php endif; ?>
                                                    <?php elseif ($seoKey == 'Social_Media') : ?>
                                                        <?php if (empty($seoValue['Facebook']) || empty($seoValue['twitter'])) : ?>
                                                            <p>This webpage is using social media meta tags.</p>
                                                        <?php else : ?>
                                                            <p>This webpage is not connected with social media using the API's provided by Facebook, Gmail, Twitter, Pinterest, or using.</p>
                                                        <?php endif; ?>
                                                    <?php elseif ($seoKey == 'Image_Alt') : ?>
                                                        <?php if ((count($seoValue) > 0)) : ?>
                                                            <p>This webpage is using "img" tags with empty or missing "alt" attribute!</p>
                                                            <div class="mcbBlockText mcbBlockRed">
                                                                <?php foreach ($seoValue as $key => $value) {
                                                                    echo $value->url . '<br>';
                                                                } ?>
                                                            </div>
                                                        <?php else : ?>
                                                            <p>This webpage is using "img" tags with "alt" attribute!</p>
                                                        <?php endif; ?>
                                                    <?php endif; ?>
                                                <?php elseif ($seoKey == 'Meta_Description') : ?>
                                                    <?php if (!empty($seoValue)) : ?>
                                                        This webpage is using a meta description tag.
                                                        <div class="mcbBlockText mcbBlockGreen">
                                                            <div><strong>Text : </strong> <?= $seoValue ?></div>
                                                            <div><strong>Length : </strong><?= strlen($seoValue) ?> characters</div>
                                                        </div>
                                                    <?php else : ?>
                                                        <p>This webpage is not using a description meta tag.</p><br>
                                                    <?php endif; ?>
                                                <?php elseif ($seoKey == 'Charset_Declaration') : ?>
                                                    <?php if (!empty($seoValue)) : ?>
                                                        <p> This webpage has a character encoding declaration. </p>
                                                        <div class="mcbBlockText mcbBlockGreen">
                                                            <?= htmlspecialchars('Content-Type: text/html; charset=UTF-8') ?>
                                                        </div>
                                                    <?php else : ?>
                                                        <p> This webpage has not a character encoding declaration. </p>
                                                    <?php endif; ?>

                                                <?php elseif ($seoKey == 'Meta_Viewport') : ?>
                                                    <?php if (!empty($seoValue)) : ?>
                                                        <p>This webpage is using a viewport meta tag.</p>
                                                        <div class="mcbBlockText mcbBlockGreen">
                                                            <?= htmlspecialchars('<meta name="viewport" content="' . $seoValue . '" />') ?>
                                                        </div>
                                                    <?php else : ?>
                                                        <p>This webpage is Not using a viewport meta tag.</p>
                                                    <?php endif; ?>
                                                <?php elseif ($seoKey == 'Canonical_Tag') : ?>
                                                    <?php if (!empty($seoValue)) : ?>
                                                        <p>This webpage is using the canonical link tag. This tag specifies that the URL: <a><?= $seoValue ?></a> is preferred to be used in search results. Please ensure that this specification is correct, as canonical tags are often hard-coded and may not always reflect the latest changes in a site's URL structure.</p>
                                                        <div class="mcbBlockText  mcbBlockGreen">
                                                            <?= htmlspecialchars('<link href="' . $seoValue . '" rel="canonical"/>') ?>
                                                        </div>
                                                    <?php else : ?>
                                                        <p>This webpage does not use the canonical link tag.</p>
                                                    <?php endif; ?>

                                                <?php elseif ($seoKey == 'Meta_Title') : ?>
                                                    <?php if (!empty($seoValue)) : ?>
                                                        <p> This webpage is using a title tag with a length of <strong><?= strlen($seoValue) ?> characters</strong>.
                                                            While there's no target number of characters, titles should be descriptive and concise.
                                                            We recommend using a title with a length <strong>between 20 - 60 characters</strong>
                                                            in order to fit Google Search results that have a 600-pixel limit.</p>
                                                        <div class="mcbBlockText mcbBlockGreen">
                                                            <div><strong>Text : </strong> <?= $seoValue ?></div>
                                                            <div><strong>Length : </strong><?= strlen($seoValue) ?> characters</div>
                                                        </div>
                                                    <?php else : ?>
                                                        <p>This webpage is not using a title meta tag.</p><br>
                                                    <?php endif; ?>
                                                <?php endif; ?>

                                            </div>
                                    <?php endif;
                                    endforeach; ?>
                                <?php else : ?>
                                    <p class="not-found ">No records found.</p>
                                <?php endif; ?>



                            </div>
                            <div class="tab-pane fade" id="pills-profile2" role="tabpanel" aria-labelledby="pills-profile-tab">
                                <?php
                                if (isset($warningPerformanceSeo) && $warningPerformanceSeo != 0) :
                                    foreach ($recommendedData['seo'] as $perforValue) :
                                        if (($perforValue->score < 0.9 && $perforValue->score >= 0.5)) :
                                ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon">
                                                        <!-- <img src="<?//php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"> -->
                                                    </span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <!-- <a href="javascript:void(0);" class="see-full-list ">See Full List <i class="fa-solid fa-arrow-up-right-from-square"></i></a> -->
                                                <a href="javascript:void(0);" class="primary-btn howToFix">How to fix <i class="fas fa-chevron-down"></i></a>
                                                <div class="mvbsbContentBox">
                                                    <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach;
                                else :
                                    ?>
                                    <p class="not-found ">No records found.</p>
                                <?php endif; ?>
                            </div>
                            <div class="tab-pane fade" id="pills-contact3" role="tabpanel" aria-labelledby="pills-contact-tab">
                                <?php
                                if (isset($recommendedData['seo']) /* && count($recommendedData['seo']) > 0 */) :
                                    if (isset($passedSeoArray) && count($passedSeoArray) > 0) :
                                        foreach ($passedSeoArray as $pkey => $perforValue) :
                                            $score = $perforValue->score;
                                ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class="scan-detailes-list-icon <?= getIconColor($perforValue->score) ?>"><img src="<?php echo esc_html(UPKPR_UPKEPR_WS_PATH1); ?>images/critical-icon.png"></span>
                                                    <h4> <?= htmlentities($perforValue->title) ?></h4>
                                                    <p> <?= htmlspecialchars($perforValue->title) . ' <strong>' . @$perforValue->displayValue . '</strong>' ?>
                                                        <?= formatTextWithLinks($perforValue->description) ?></p>
                                                </div>
                                                <?= getAuditsdetailsItems($perforValue, $site_url) ?>
                                                <a href="#" class="primary-btn">How to fix <i class="fas fa-chevron-down"></i>
                                                    
                                                </a>
                                                <div class="mvbsbContentBox">
                                                        <?= @$metricsxData[$perforValue->id]; ?>
                                                </div>
                                            </div>
                                        <?php
                                        endforeach; ?>

                                    <?php else : ?>
                                      <!--   <p class="not-found ">No records found.</p> -->
                                        <?php endif;
                                    foreach ($seodAdvanceDataWithPackage as $seoKey => $seoValue) :
                                        if (!in_array($seoKey, $scraperErrors)) :

                                        ?>
                                            <div class="scan-summry-detail-list">
                                                <div class="scan-summry-detail-list-header">
                                                    <span class=" scan-detailes-list-icon tbliIcon <?= !in_array($seoKey, $scraperErrors) ? 'tbliIconGreen' : 'tbliIconRed'; ?> me-2">
                                                        <i class="fa-solid fa-<?= !in_array($seoKey, $scraperErrors) ? 'check' : 'exclamation'; ?>"></i></span>
                                                    <h4> <?= str_replace('_', ' ', $seoKey) ?> </h4>
                                                </div>
                                                <div class="scan-summry-detail-list-header">
                                                    <?php if ($seoValue && is_array($seoValue)) : ?>
                                                        <?php if ($seoKey == 'Heading_Tags') : ?>
                                                            <p>This webpage contains headings tags</p>
                                                            <p>
                                                            <div class="row">
                                                                <?php foreach ($seoValue as $Hkey => $HseodAdvanceData) { ?>
                                                                    <div class="cstm-tab-content  col-6">
                                                                        <table class="table table table-striped">
                                                                            <thead class="social-table-containe">
                                                                                <th><?= $Hkey ?>
                                                                                    <hr>
                                                                                </th>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td><?= implode("<br> \n", $HseodAdvanceData) ?></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                <?php } ?>
                                                            </div>
                                                            </p>
                                                            <!-- Social media seo -->
                                                        <?php elseif ($seoKey == 'Social_Media_Meta_Tags') : ?>
                                                            <?php if (!empty($seoValue['social']) || !empty($seoValue['twitter'])) : ?>
                                                                <p>This webpage is using social media meta tags.</p>

                                                                <?php foreach ($seoValue as $Hkey => $HseodAdvanceData) { ?>
                                                                    <header class="social-table-containe">
                                                                        <strong><?= ($Hkey == 'social') ? 'Open Graph Meta Tags' : 'Twitter Card Meta Tags'; ?></strong>
                                                                    </header>
                                                                    <div class="mcbBlockText mcbBlockGrey">
                                                                        <div class="cstm-tab-content table-responsive">
                                                                            <table class="table table table-striped ">
                                                                                <tbody>
                                                                                    <?php foreach ($HseodAdvanceData as $keyM => $Mvalue) { ?>
                                                                                        <tr>
                                                                                            <td><?= $keyM ?></td>
                                                                                            <td><?= $Mvalue ?></td>
                                                                                        </tr>
                                                                                    <?php } ?>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </div>
                                                                <?php } ?>
                                                            <?php else : ?>
                                                                <p>This webpage is not using social media meta tags! While this type of meta tags don't affect what
                                                                    people see when they visit the webpage, they exist to provide information about it to search engines
                                                                    and social media platforms.</p>
                                                            <?php endif; ?>
                                                        <?php elseif ($seoKey == 'Social_Media') : ?>
                                                            <?php if (empty($seoValue['Facebook']) || empty($seoValue['twitter'])) : ?>
                                                                <p>This webpage is using social media meta tags.</p>
                                                            <?php else : ?>
                                                                <p>This webpage is not connected with social media using the API's provided by Facebook, Gmail, Twitter, Pinterest, or using.</p>
                                                            <?php endif; ?>
                                                        <?php elseif ($seoKey == 'Image_Alt') : ?>
                                                            <?php if ((count($seoValue) > 0)) : ?>
                                                                <p>This webpage is using "img" tags with empty or missing "alt" attribute!</p>
                                                                <p>
                                                                    <?php foreach ($seoValue as $key => $value) {
                                                                        echo $value['url'] . '<br>';
                                                                    } ?>
                                                                </p>
                                                            <?php else : ?>
                                                                <p>This webpage is using "img" tags with "alt" attribute!</p>
                                                            <?php endif; ?>
                                                        <?php endif; ?>
                                                    <?php elseif ($seoKey == 'Meta_Description') : ?>
                                                        <?php if (!empty($seoValue)) : ?>
                                                            <p> This webpage is using a meta description tag. </p>
                                                            <p>
                                                            <div><strong>Text : </strong> <?= $seoValue ?></div>
                                                            <div><strong>Length : </strong><?= strlen($seoValue) ?> characters</div>
                                                            </p>
                                                        <?php else : ?>
                                                            <p>This webpage is not using a description meta tag.</p><br>
                                                        <?php endif; ?>
                                                    <?php elseif ($seoKey == 'Charset_Declaration') : ?>
                                                        <?php if (!empty($seoValue)) : ?>
                                                            <p> This webpage has a character encoding declaration. </p>
                                                            <p>
                                                                <?= htmlspecialchars('Content-Type: text/html; charset=UTF-8') ?>
                                                            </p>
                                                        <?php else : ?>
                                                            <p> This webpage has not a character encoding declaration. </p>
                                                        <?php endif; ?>

                                                    <?php elseif ($seoKey == 'Meta_Viewport') : ?>
                                                        <?php if (!empty($seoValue)) : ?>
                                                            <p>This webpage is using a viewport meta tag.</p>
                                                            <p>
                                                                <?= htmlspecialchars('<meta name="viewport" content="' . $seoValue . '" />') ?>
                                                            </p>
                                                        <?php else : ?>
                                                            <p>This webpage is Not using a viewport meta tag.</p>
                                                        <?php endif; ?>
                                                    <?php elseif ($seoKey == 'Canonical_Tag') : ?>
                                                        <?php if (!empty($seoValue)) : ?>
                                                            <p>This webpage is using the canonical link tag. This tag specifies that the URL: <a><?= $seoValue ?></a> is preferred to be used in search results. Please ensure that this specification is correct, as canonical tags are often hard-coded and may not always reflect the latest changes in a site's URL structure.</p>
                                                            <p>
                                                                <?= htmlspecialchars('<link href="' . $seoValue . '" rel="canonical"/>') ?>
                                                            </p>
                                                        <?php else : ?>
                                                            <p>This webpage does not use the canonical link tag.</p>
                                                        <?php endif; ?>

                                                    <?php elseif ($seoKey == 'Meta_Title') : ?>
                                                        <?php if (!empty($seoValue)) : ?>
                                                            <p> This webpage is using a title tag with a length of <strong><?= strlen($seoValue) ?> characters</strong>.
                                                                While there's no target number of characters, titles should be descriptive and concise.
                                                                We recommend using a title with a length <strong>between 20 - 60 characters</strong>
                                                                in order to fit Google Search results that have a 600-pixel limit.</p>
                                                            <p>
                                                            <div><strong>Text : </strong> <?= $seoValue ?></div>
                                                            <div><strong>Length : </strong><?= strlen($seoValue) ?> characters</div>
                                                            </p>
                                                        <?php else : ?>
                                                            <p>This webpage is not using a title meta tag.</p><br>
                                                        <?php endif; ?>
                                                    <?php endif; ?>

                                                    <?php if (in_array($seoKey, $scraperErrors)) : ?>
                                                        <!--    <div class="mcbSuggestionBox">
                                                                    <button class="mvbsbButton">
                                                                        How to fix <i class="fa-solid fa-angle-up"></i>
                                                                    </button>
                                                                    <div class="mvbsbContentBox">
                                                                        <? //=getSignupModalhtml()
                                                                        ?>
                                                                    </div>
                                                                  </div> -->
                                                    <?php endif; ?>
                                                </div>
                                            </div>
                                    <?php endif;
                                    endforeach; ?>
                                <?php else : ?>
                                    <p class="not-found ">No records found.</p>
                                <?php endif; ?>

                            </div>
                        </div>
                    </div>

                </div>
            </div>
</section>
<?php } ?>
<script>
    jQuery(document).ready(function() {
        var averageScore = '<?= $averageScore ?>';
        if (averageScore < 90 && averageScore >= 50) {
            jQuery('.gpsInnerSec > .gpsOrange').addClass('highlight');
        } else if (averageScore < 50) {
            jQuery('.gpsInnerSec > .gpsRed').addClass('highlight');
        } else {
            jQuery('.gpsInnerSec > .gpsGreen').addClass('highlight');
        }
        <?php if ($screentype == 'desktop') : ?>
            jQuery('.cms_new_data > ul > li > a').click(function() {
                jQuery('.cms_new_data > ul > li > a').removeClass('active');
                jQuery(this).addClass('active');
            });
        <?php endif; ?>

        <?php if ($screentype == 'desktop') : ?>
            jQuery("#DesktophtmlLighthouse .mvbsbButton").on("click", function() {
                jQuery(this).parent().find(".mvbsbContentBox").slideToggle();
            });

            jQuery("#DesktophtmlLighthouse .mvbsbButtonClose").on("click", function() {
                jQuery(this).closest(".mcbSuggestionBox").find(".mvbsbButton").trigger("click");
            });

            jQuery("#DesktophtmlLighthouse .mvbsbButton").on("click", function() {
                jQuery(this).toggleClass('active');
            });
        <?php endif; ?>
        jQuery('a.hiderow-button-click').click(function() {
            var calssTr = jQuery(this).data('targeitem');
            jQuery('tr.' + calssTr).toggle();
            console.log(jQuery(this).text().trim());
            if (jQuery(this).text().trim() === 'See Full List') {
                var buttonText = 'See Less List <i class="fa-solid fa-minus"></i>';
                jQuery(this).toggleClass('active');
            } else {
                var buttonText = 'See Full List <i class="fa-solid fa-plus"></i>';
                jQuery(this).toggleClass('active');
            }
            jQuery(this).html(buttonText);
        });

        jQuery('.howToFix').click(function(event){
            jQuery(this).next('.mvbsbContentBox').toggle();
            jQuery(this).toggleClass('active');
        });
    });
</script>
<!-- Health reports start-->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var accToggles = document.querySelectorAll('.upkpr-accordion-toggle');
        accToggles.forEach(function(toggle) {
            toggle.addEventListener('click', function() {
                this.classList.toggle('active');
                var content = this.closest('tr').nextElementSibling;
                if (content.style.display === "none") {
                    content.style.display = "";
                } else {
                    content.style.display = "none";
                }
            });
        });
    });
</script>